import mysql.connector
from faker import Faker
import random
from datetime import datetime

fake = Faker("ko_KR")  # âœ… í•œê¸€ ë¡œì¼€ì¼ ì ìš©

# âœ… í•œê¸€ ë¬¸ì˜ & ë‹µë³€ í…œí”Œë¦¿ (í™•ì¥)
inquiry_samples = [
    "ë°°ì†¡ì´ ë„ˆë¬´ ëŠ¦ì–´ìš”. ì–¸ì œ ë„ì°©í•˜ë‚˜ìš”?",
    "ìƒí’ˆì´ ë¶ˆëŸ‰ì´ì–´ì„œ êµí™˜ ìš”ì²­í•©ë‹ˆë‹¤.",
    "ê²°ì œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. í™•ì¸ ë¶€íƒë“œë ¤ìš”.",
    "íšŒì› íƒˆí‡´ëŠ” ì–´ë–»ê²Œ í•˜ë‚˜ìš”?",
    "ì¬ê³ ê°€ ì–¸ì œ ë‹¤ì‹œ ë“¤ì–´ì˜¤ë‚˜ìš”?",
    "ì¿ í°ì„ ì‚¬ìš©í–ˆëŠ”ë° í• ì¸ ì ìš©ì´ ì•ˆ ë˜ì—ˆì–´ìš”.",
    "ë°˜í’ˆ ìš”ì²­í•˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í•˜ë‚˜ìš”?",
    "ì œí’ˆ ìƒì„¸ ì •ë³´ì— ì—†ëŠ” ì¶”ê°€ ì •ë³´ê°€ ê¶ê¸ˆí•©ë‹ˆë‹¤.",
    "í¬ì¸íŠ¸ ì ë¦½ì´ ì•ˆ ë˜ì—ˆì–´ìš”. í™•ì¸í•´ì£¼ì„¸ìš”.",
    "ì‚¬ì´íŠ¸ì—ì„œ ë¡œê·¸ì¸ ì˜¤ë¥˜ê°€ ë‚©ë‹ˆë‹¤.",
    "ë°°ì†¡ì´ ì—‰ëš±í•œ ì£¼ì†Œë¡œ ê°”ì–´ìš”. ë‹¤ì‹œ ë°°ì†¡ë°›ì„ ìˆ˜ ìˆì„ê¹Œìš”?",
    "íšŒì›ê°€ì… ì‹œ ì´ë©”ì¼ ì¸ì¦ì´ ì•ˆ ë¼ìš”.",
    "ì£¼ë¬¸ì„ ì·¨ì†Œí•˜ê³  ì‹¶ì€ë° í™˜ë¶ˆì€ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?",
    "ìƒí’ˆ ì„¤ëª…ê³¼ ì‹¤ì œ ì œí’ˆì´ ë‹¬ë¼ìš”. ë°˜í’ˆ ê°€ëŠ¥í•œê°€ìš”?",
    "ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í•˜ë‚˜ìš”?",
    "ì¹´ì¹´ì˜¤í˜ì´ë¡œ ê²°ì œí–ˆëŠ”ë° ê²°ì œ ë‚´ì—­ì´ ì•ˆ ë³´ì—¬ìš”.",
    "í• ì¸ ì´ë²¤íŠ¸ëŠ” ì–¸ì œê¹Œì§€ ì§„í–‰ë˜ë‚˜ìš”?",
    "ì„ ë¬¼ìš©ìœ¼ë¡œ í¬ì¥ ê°€ëŠ¥í•œê°€ìš”?",
    "ë¦¬ë·°ë¥¼ ì‘ì„±í•˜ë©´ í¬ì¸íŠ¸ ì ë¦½ì´ ë˜ë‚˜ìš”?",
    "ì ë¦½ëœ í¬ì¸íŠ¸ë¥¼ ì–´ë–»ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‚˜ìš”?"
]

answer_samples = [
    "ê³ ê°ë‹˜, ë°°ì†¡ì´ ì§€ì—°ë˜ì–´ ì£„ì†¡í•©ë‹ˆë‹¤. ë¹ ë¥¸ ì‹œì¼ ë‚´ ë„ì°©í•  ìˆ˜ ìˆë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.",
    "êµí™˜ ì ˆì°¨ëŠ” ë§ˆì´í˜ì´ì§€ì—ì„œ ì‹ ì²­ ê°€ëŠ¥í•©ë‹ˆë‹¤. ìì„¸í•œ ì‚¬í•­ì€ ê³ ê°ì„¼í„°ë¡œ ë¬¸ì˜í•´ì£¼ì„¸ìš”.",
    "ê²°ì œ ì˜¤ë¥˜ëŠ” ì¹´ë“œì‚¬ ë¬¸ì œì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ í•œ ë²ˆ ì‹œë„í•´ë³´ì‹œê³ , ì§€ì†ë˜ë©´ ì—°ë½ì£¼ì„¸ìš”.",
    "íšŒì› íƒˆí‡´ëŠ” ì„¤ì • í˜ì´ì§€ì—ì„œ ê°€ëŠ¥í•©ë‹ˆë‹¤. ê³„ì • ì‚­ì œ í›„ ë³µêµ¬ê°€ ë¶ˆê°€ëŠ¥í•˜ë‹ˆ ìœ ì˜í•´ì£¼ì„¸ìš”.",
    "í˜„ì¬ ì¬ê³  í™•ë³´ ì¤‘ì´ë©°, ë‹¤ìŒ ì£¼ ì¤‘ì— ì…ê³ ë  ì˜ˆì •ì…ë‹ˆë‹¤.",
    "ì¿ í° ì‚¬ìš© ì˜¤ë¥˜ë¥¼ í™•ì¸í•˜ê³  ìˆìŠµë‹ˆë‹¤. ë‹´ë‹¹ ë¶€ì„œì—ì„œ ì²˜ë¦¬ í›„ ì—°ë½ë“œë¦¬ê² ìŠµë‹ˆë‹¤.",
    "ë°˜í’ˆ ì‹ ì²­ì€ ê³ ê°ì„¼í„°ë¥¼ í†µí•´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë°˜í’ˆ ì ‘ìˆ˜ í›„ 3ì¼ ë‚´ íšŒìˆ˜ ì§„í–‰ë©ë‹ˆë‹¤.",
    "ì¶”ê°€ ì •ë³´ëŠ” ìƒí’ˆ ìƒì„¸ í˜ì´ì§€ ì—…ë°ì´íŠ¸ ì˜ˆì •ì…ë‹ˆë‹¤. ì¶”ê°€ë¡œ ê¶ê¸ˆí•œ ì ì€ ë¬¸ì˜ ì£¼ì„¸ìš”.",
    "í¬ì¸íŠ¸ ì ë¦½ ì˜¤ë¥˜ë¥¼ í™•ì¸í–ˆìŠµë‹ˆë‹¤. ì¡°ì†íˆ ì¡°ì¹˜í•˜ê² ìŠµë‹ˆë‹¤.",
    "ë¡œê·¸ì¸ ë¬¸ì œëŠ” ë¸Œë¼ìš°ì € ìºì‹œë¥¼ ì‚­ì œ í›„ ë‹¤ì‹œ ì‹œë„í•´ë³´ì‹œê¸¸ ë°”ëë‹ˆë‹¤.",
    "ë°°ì†¡ ë¬¸ì œë¡œ ë¶ˆí¸ì„ ë¼ì³ë“œë ¤ ì£„ì†¡í•©ë‹ˆë‹¤. ì¬ë°°ì†¡ ê°€ëŠ¥í•˜ë„ë¡ ì¡°ì¹˜í•˜ê² ìŠµë‹ˆë‹¤.",
    "ì´ë©”ì¼ ì¸ì¦ ë©”ì¼ì´ ìŠ¤íŒ¸í•¨ìœ¼ë¡œ ì´ë™í–ˆëŠ”ì§€ í™•ì¸í•´ ì£¼ì„¸ìš”. ê·¸ë˜ë„ ì•ˆ ë˜ë©´ ê³ ê°ì„¼í„°ë¡œ ë¬¸ì˜ ë°”ëë‹ˆë‹¤.",
    "ì£¼ë¬¸ ì·¨ì†Œ í›„ í™˜ë¶ˆì€ ì˜ì—…ì¼ ê¸°ì¤€ 3~5ì¼ ë‚´ ì²˜ë¦¬ë©ë‹ˆë‹¤.",
    "ìƒí’ˆ ë°˜í’ˆì´ ê°€ëŠ¥í•˜ë©°, ë°˜í’ˆ ì ˆì°¨ì— ëŒ€í•´ ìì„¸íˆ ì•ˆë‚´í•´ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.",
    "ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ì€ ë§ˆì´í˜ì´ì§€ > ê³„ì • ì„¤ì •ì—ì„œ ê°€ëŠ¥í•©ë‹ˆë‹¤.",
    "ê²°ì œ ë‚´ì—­ì´ í™•ì¸ë˜ì§€ ì•ŠëŠ” ê²½ìš°, ì¹´ë“œì‚¬ ë˜ëŠ” ê°„í¸ê²°ì œì‚¬ì— ë¬¸ì˜ ë¶€íƒë“œë¦½ë‹ˆë‹¤.",
    "í• ì¸ ì´ë²¤íŠ¸ëŠ” ì´ë²ˆ ë‹¬ ë§ê¹Œì§€ ì§„í–‰ë©ë‹ˆë‹¤. ê¸°íšŒë¥¼ ë†“ì¹˜ì§€ ë§ˆì„¸ìš”!",
    "ì„ ë¬¼ í¬ì¥ ì˜µì…˜ì€ ê²°ì œ í˜ì´ì§€ì—ì„œ ì„ íƒí•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
    "ë¦¬ë·° ì‘ì„± ì‹œ í¬ì¸íŠ¸ê°€ ì ë¦½ë©ë‹ˆë‹¤. ì´ë²¤íŠ¸ í˜ì´ì§€ì—ì„œ ì ë¦½ ê¸°ì¤€ì„ í™•ì¸í•˜ì„¸ìš”.",
    "ì ë¦½ëœ í¬ì¸íŠ¸ëŠ” ê²°ì œ ì‹œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤. ì‚¬ìš© ê°€ëŠ¥ í¬ì¸íŠ¸ëŠ” ë§ˆì´í˜ì´ì§€ì—ì„œ í™•ì¸í•˜ì„¸ìš”."
]

# âœ… MySQL ì—°ê²° ì„¤ì •
conn = mysql.connector.connect(
    host="112.222.157.156",      
    port= 50006,
    user="root",           
    password="1234",  
    database="sodam"
)
cursor = conn.cursor()

# âœ… (1) ê¸°ì¡´ ë°ì´í„° ì‚­ì œ (TRUNCATE TABLE â†’ AUTO_INCREMENT ì´ˆê¸°í™”)
cursor.execute("SET FOREIGN_KEY_CHECKS = 0;")
cursor.execute("TRUNCATE TABLE QnA;")
cursor.execute("SET FOREIGN_KEY_CHECKS = 1;")
conn.commit()

print("ê¸°ì¡´ ë°ì´í„° ì‚­ì œ ì™„ë£Œ!")

# âœ… (2) `customer_id` ëª©ë¡ ê°€ì ¸ì˜¤ê¸° (QnA ì‘ì„±ì)
cursor.execute("SELECT customer_id FROM Customer;")
customer_ids = [row[0] for row in cursor.fetchall()]  # âœ… ê³ ê° ID ë¦¬ìŠ¤íŠ¸

# âœ… (3) `employee_id` ëª©ë¡ ê°€ì ¸ì˜¤ê¸° (QnA ë‹µë³€ì - ì§ì›)
cursor.execute("SELECT employee_id FROM Employees;")
employee_ids = [row[0] for row in cursor.fetchall()]  # âœ… ì§ì› ID ë¦¬ìŠ¤íŠ¸

# âœ… (4) ìƒíƒœ ENUM ê°’ ì •ì˜
statuses = ['Pending', 'Completed']

# âœ… (5) QnA ë°ì´í„° ìƒì„± ë° ì‚½ì…
if customer_ids:
    num_records = 1000000  # âœ… ìƒì„±í•  ë°ì´í„° ê°œìˆ˜
    batch_size = 10000  # âœ… ëŒ€ëŸ‰ ì‚½ì…ì„ ìœ„í•œ ë°°ì¹˜ í¬ê¸°
    qna_to_insert = []

    for _ in range(num_records):
        customer_id = random.choice(customer_ids)  # âœ… ê³ ê° ID ì„ íƒ
        inquiry_content = random.choice(inquiry_samples)  # âœ… í•œê¸€ ë¬¸ì˜ ë‚´ìš© ì„ íƒ
        inquiry_time = fake.date_time_between(start_date="-1y", end_date="now")  # âœ… ìµœê·¼ 1ë…„ ë‚´ ë¬¸ì˜ ì‹œê°„
        image = fake.image_url() if random.random() < 0.3 else None  # âœ… 30% í™•ë¥ ë¡œ ì´ë¯¸ì§€ í¬í•¨
        status = random.choice(statuses)  # âœ… ìƒíƒœ ê°’ ëœë¤ ì„ íƒ

        if status == "Completed" and employee_ids:  # âœ… ë‹µë³€ ì™„ë£Œëœ ê²½ìš°
            employee_id = random.choice(employee_ids)  # âœ… ëœë¤ ì§ì› ë°°ì •
            answer_time = fake.date_time_between(start_date=inquiry_time, end_date="now")  # âœ… ë¬¸ì˜ ì´í›„ ëœë¤ ë‹µë³€ ì‹œê°„
            answer_content = random.choice(answer_samples)  # âœ… í•œê¸€ ë‹µë³€ ë‚´ìš© ì„ íƒ
        else:
            employee_id = None
            answer_time = None
            answer_content = None

        qna_to_insert.append((customer_id, inquiry_content, image, inquiry_time, status, employee_id, answer_time, answer_content))

        # âœ… ì¼ì • ê°œìˆ˜ë§ˆë‹¤ DBì— ì‚½ì… (ë°°ì¹˜ ì²˜ë¦¬)
        if len(qna_to_insert) >= batch_size:
            sql_qna = """
            INSERT INTO QnA (customer_id, inquiry_content, image, inquiry_time, status, employee_id, answer_time, answer_content)
            VALUES (%s, %s, %s, %s, %s, %s, %s, %s);
            """
            cursor.executemany(sql_qna, qna_to_insert)
            conn.commit()
            qna_to_insert = []

    # âœ… ë§ˆì§€ë§‰ ë‚¨ì€ ë°ì´í„° ì‚½ì…
    if qna_to_insert:
        sql_qna = """
        INSERT INTO QnA (customer_id, inquiry_content, image, inquiry_time, status, employee_id, answer_time, answer_content)
        VALUES (%s, %s, %s, %s, %s, %s, %s, %s);
        """
        cursor.executemany(sql_qna, qna_to_insert)
        conn.commit()

    print("QnA ë°ì´í„° ì‚½ì… ì™„ë£Œ!")

# âœ… (6) ì»¤ì„œ ë° ì—°ê²° ì¢…ë£Œ
cursor.close()
conn.close()

print("ë¬¸ì˜(QnA) ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì‚½ì…ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸš€")
